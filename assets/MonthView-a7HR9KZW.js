import{c as U,d as Y,b as B,r as g,j as e,T as Z,X as M}from"./index-ovijGZFu.js";import{a as _,b as E,c as H,d as V}from"./useTrades-DNPgfRGS.js";import{u as X,f as j,g as G}from"./useTags-Dd4AQWGC.js";import{u as K}from"./settingsStore-Orr4jE45.js";import{T as Q}from"./trash-2-Bry7243m.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=U("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),me=()=>{const{year:a,month:o}=Y(),l=B(),s=new Date,m=parseInt(a)||s.getFullYear(),d=o!==void 0?parseInt(o):s.getMonth(),{data:r=[],isLoading:x}=_(m,d),{data:i=[]}=X(),n=K(t=>t.settings.currency),[c,u]=g.useState(null),[v,N]=g.useState(!1),[A,y]=g.useState(!1),[P,w]=g.useState(null),F=["January","February","March","April","May","June","July","August","September","October","November","December"],L=new Date(m,d+1,0).getDate(),$=new Date(m,d,1).getDay(),k=r.reduce((t,b)=>t+b.amount,0),T=r.filter(t=>t.amount>0),z=r.filter(t=>t.amount<0),S=r.length>0?Math.round(T.length/r.length*100):0,I=re(r),p={};r.forEach(t=>{const b=parseInt(t.date.split("-")[2]);p[b]||(p[b]=[]),p[b].push(t)});const R=t=>{if((p[t]||[]).length===0){const h=`${m}-${String(d+1).padStart(2,"0")}-${String(t).padStart(2,"0")}`;w(h),y(!0)}},C=t=>{u(t),N(!0)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950",style:{paddingTop:"80px"},children:[e.jsx("div",{className:"border-b border-slate-700/50 bg-slate-900/50 backdrop-blur-sm px-6 py-4",children:e.jsxs("div",{className:"max-w-[1800px] mx-auto flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>l("/"),className:"flex items-center gap-3 hover:opacity-80 transition-opacity",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-purple-600 p-2 rounded-xl",children:e.jsx(Z,{size:24,className:"text-white"})}),e.jsx("span",{className:"text-2xl font-black bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"TradeZen"})]}),e.jsxs("h1",{className:"text-2xl font-black",children:[F[d]," ",m]}),e.jsx("div",{className:"w-10 h-10"})," "]})}),e.jsx("div",{className:"max-w-[1800px] mx-auto p-6",children:e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-9",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>e.jsx("div",{className:"text-center text-slate-400 text-sm font-semibold py-2",children:t},t))}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[Array.from({length:$}).map((t,b)=>e.jsx("div",{className:"aspect-square"},`empty-${b}`)),Array.from({length:L}).map((t,b)=>{const h=b+1,D=p[h]||[],q=D.reduce((W,J)=>W+J.amount,0),O=h===s.getDate()&&d===s.getMonth()&&m===s.getFullYear();return e.jsx(te,{day:h,trades:D,dayPL:q,isToday:O,currency:n,onClick:()=>R(h),onEditTrade:C},h)})]})]}),r.length>0&&e.jsxs("div",{className:"mt-6 bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-center",children:"All Trades This Month"}),e.jsx("div",{className:"space-y-2",children:r.map(t=>e.jsx(se,{trade:t,currency:n,onEdit:()=>C(t)},t.tradeId))})]})]}),e.jsxs("div",{className:"col-span-3 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Month Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(f,{label:"Total P&L",value:j(k,n),color:k>=0?"emerald":"red"}),e.jsx(f,{label:"Trades",value:r.length}),e.jsx(f,{label:"Winners",value:T.length,color:"emerald"}),e.jsx(f,{label:"Losers",value:z.length,color:"red"}),e.jsx(f,{label:"Win Rate",value:`${S}%`,color:S>=50?"emerald":"red"})]})]}),I.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Strategies"}),e.jsx("div",{className:"space-y-3",children:I.map(t=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:t.tagEmoji}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-xs font-bold truncate",style:{color:t.tagColor},children:t.tagName})})]}),e.jsx("div",{className:`text-lg font-black ${t.totalPL>=0?"text-emerald-400":"text-red-400"}`,children:j(t.totalPL,n)}),e.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:[t.trades,"T â€¢ ",t.winRate,"% WR"]})]},t.tagId))})]})]})]})}),v&&c&&e.jsx(ae,{trade:c,tags:i,currency:n,onClose:()=>{N(!1),u(null)}}),A&&e.jsx(le,{date:P,tags:i,currency:n,onClose:()=>{y(!1),w(null)}})]})},te=({day:a,trades:o,dayPL:l,isToday:s,currency:m,onClick:d,onEditTrade:r})=>{const x=o.length>0,i=x?l>0?"bg-emerald-900/20 border-emerald-500/30":"bg-red-900/20 border-red-500/30":"bg-slate-800/20 border-slate-700/30";return e.jsxs("div",{onClick:()=>!x&&d(),className:`aspect-square rounded-lg border ${i} ${s?"ring-2 ring-blue-500":""} p-2 relative hover:bg-slate-700/30 transition-all ${x?"":"cursor-pointer"}`,children:[e.jsx("div",{className:"text-sm font-semibold text-slate-300",children:a}),x&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center text-lg font-black ${l>=0?"text-emerald-400":"text-red-400"}`,children:j(l,m)}),e.jsx("div",{className:"absolute bottom-1 left-1 flex flex-wrap gap-1 max-w-[80%]",children:[...new Set(o.map(n=>n.tagName).filter(Boolean))].map(n=>e.jsx("span",{className:"text-[8px] text-slate-400 bg-slate-900/70 px-1 rounded truncate",children:n},n))}),o.length>1&&e.jsx("div",{className:"absolute bottom-1 right-1 text-[9px] text-slate-500 font-semibold",children:o.length}),e.jsx("button",{onClick:n=>{n.stopPropagation(),o.length===1&&r(o[0])},className:"absolute inset-0 opacity-0 hover:opacity-5 bg-white transition-opacity rounded-lg"})]})]})},se=({trade:a,currency:o,onEdit:l})=>{const s=E(),m=async()=>{if(confirm("Delete this trade?"))try{await s.mutateAsync(a.tradeId)}catch(d){alert("Failed to delete: "+d.message)}};return e.jsxs("div",{className:"bg-slate-800/30 rounded-lg p-4 flex items-center gap-4 hover:bg-slate-800/50 transition-all group",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"text-xs text-slate-500",children:a.time})}),e.jsxs("div",{className:"flex-1",children:[a.tagName&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:a.tagEmoji}),e.jsx("span",{className:"text-xs font-semibold",style:{color:a.tagColor},children:a.tagName})]}),a.notes&&e.jsx("div",{className:"text-xs text-slate-400 truncate",children:a.notes})]}),e.jsx("div",{className:`text-xl font-black ${a.amount>=0?"text-emerald-400":"text-red-400"}`,children:j(a.amount,o)}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:l,className:"p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all",children:e.jsx(ee,{size:16})}),e.jsx("button",{onClick:m,className:"p-2 bg-red-600 hover:bg-red-700 rounded-lg transition-all",children:e.jsx(Q,{size:16})})]})]})},ae=({trade:a,tags:o,currency:l,onClose:s})=>{const m=H(),d=E(),[r,x]=g.useState({amount:a.amount,time:a.time,tagId:a.tagId||"",notes:a.notes||""}),i=async c=>{c.preventDefault();try{const u=o.find(v=>v.tagId===r.tagId);await m.mutateAsync({tradeId:a.tradeId,updates:{...r,tagName:(u==null?void 0:u.name)||null,tagColor:(u==null?void 0:u.color)||null,tagEmoji:(u==null?void 0:u.emoji)||null}}),s()}catch(u){alert("Failed to update: "+u.message)}},n=async()=>{if(confirm("Delete this trade? This cannot be undone."))try{await d.mutateAsync(a.tradeId),s()}catch(c){alert("Failed to delete: "+c.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"Edit Trade"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(M,{size:20})})]}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:a.date,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:r.time,onChange:c=>x({...r,time:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",l,")"]}),e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:c=>x({...r,amount:parseFloat(c.target.value)}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:r.tagId,onChange:c=>x({...r,tagId:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),o.map(c=>e.jsxs("option",{value:c.tagId,children:[c.emoji," ",c.name]},c.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:r.notes,onChange:c=>x({...r,notes:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg transition-all font-semibold",children:"Delete"}),e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold",children:"Save"})]})]})]})})},le=({date:a,tags:o,currency:l,onClose:s})=>{const m=V(),[d,r]=g.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:""}),x=async i=>{i.preventDefault();try{const n=o.find(c=>c.tagId===d.tagId);await m.mutateAsync({tradeId:G(),date:a,time:d.time,amount:parseFloat(d.amount),tagId:d.tagId||null,tagName:(n==null?void 0:n.name)||null,tagColor:(n==null?void 0:n.color)||null,tagEmoji:(n==null?void 0:n.emoji)||null,notes:d.notes,driveImageId:null}),s()}catch(n){alert("Failed to save: "+n.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"New Trade"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(M,{size:20})})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:a,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:d.time,onChange:i=>r({...d,time:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",l,")"]}),e.jsx("input",{type:"number",step:"0.01",value:d.amount,onChange:i=>r({...d,amount:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",placeholder:"e.g., 100 or -50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:d.tagId,onChange:i=>r({...d,tagId:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),o.map(i=>e.jsxs("option",{value:i.tagId,children:[i.emoji," ",i.name]},i.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:d.notes,onChange:i=>r({...d,notes:i.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3,placeholder:"Trade notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold",children:"Save Trade"})]})]})]})})},f=({label:a,value:o,color:l})=>{const s=l==="emerald"?"text-emerald-400":l==="red"?"text-red-400":"text-white";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wider",children:a}),e.jsx("span",{className:`text-lg font-black ${s}`,children:o})]})},re=a=>{const o={};return a.forEach(l=>{const s=l.tagId||"none";s!=="none"&&(o[s]||(o[s]={tagId:s,tagName:l.tagName,tagColor:l.tagColor,tagEmoji:l.tagEmoji,totalPL:0,trades:0,wins:0}),o[s].totalPL+=l.amount,o[s].trades+=1,l.amount>0&&(o[s].wins+=1))}),Object.values(o).map(l=>({...l,winRate:l.trades>0?Math.round(l.wins/l.trades*100):0})).sort((l,s)=>s.totalPL-l.totalPL)};export{me as default};

import{f as L,j as e,X as S,r as j,h as he,a as be,b as ge,d as X,e as pe}from"./index-C8lc-GUZ.js";import{a as fe,b as U,c as je,d as Z}from"./useTrades-jBeK0X9V.js";import{a as C,u as ve,g as K}from"./useTags-8PaOiWGw.js";import{T as Q}from"./trash-2-C52cUm_N.js";import{P as Ne}from"./plus-BLDbHr7F.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=L("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=L("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=L("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=L("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=L("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ke=({imageUrl:x,trade:s,currency:o,privacyMode:n,onClose:d})=>{const t=l=>n?"****":`${o}${Math.abs(l).toLocaleString()}`;return e.jsx("div",{className:"fixed inset-0 bg-black/95 z-[60] flex items-center justify-center p-2 sm:p-4",onClick:d,children:e.jsxs("div",{className:"relative w-full h-full max-w-6xl max-h-[90vh] flex flex-col",onClick:l=>l.stopPropagation(),children:[e.jsx("button",{onClick:d,className:"absolute top-2 right-2 sm:top-4 sm:right-4 z-10 p-2 sm:p-3 bg-black/70 hover:bg-black/90 rounded-full transition-all",children:e.jsx(S,{size:20,className:"sm:w-6 sm:h-6 text-white"})}),e.jsx("div",{className:"flex-1 flex items-center justify-center overflow-hidden rounded-lg sm:rounded-xl",children:e.jsx("img",{src:x,alt:"Trade Screenshot",className:"max-w-full max-h-full object-contain cursor-zoom-in",style:{touchAction:"pinch-zoom"}})}),e.jsxs("div",{className:"mt-3 sm:mt-4 bg-slate-900/90 backdrop-blur-sm rounded-lg sm:rounded-xl p-3 sm:p-4 border border-slate-700/50",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[s.tagEmoji&&s.tagName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg sm:text-xl",children:s.tagEmoji}),e.jsx("span",{className:"text-xs sm:text-sm font-semibold",style:{color:s.tagColor},children:s.tagName})]}),e.jsxs("span",{className:"text-xs sm:text-sm text-slate-400",children:[new Date(s.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),s.time&&` • ${s.time}`]})]}),e.jsxs("div",{className:`text-xl sm:text-2xl font-black ${s.amount>=0?"text-emerald-400":"text-red-400"}`,children:[s.amount>=0?"+":"-",t(s.amount)]})]}),s.notes&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-700/50",children:e.jsx("p",{className:"text-xs sm:text-sm text-slate-300 leading-relaxed",children:s.notes})})]})]})})},Se=({tag:x,trades:s,scope:o,currency:n,privacyMode:d,onClose:t,onEditTrade:l,onDeleteTrade:f,onViewImage:u})=>{const[h,p]=j.useState("latest"),[c,i]=j.useState("all"),m=s.reduce((r,y)=>r+y.amount,0),b=s.filter(r=>r.amount>0),N=s.filter(r=>r.amount<0),g=s.length>0?Math.round(b.length/s.length*100):0,k=b.length>0?b.reduce((r,y)=>r+y.amount,0)/b.length:0,A=N.length>0?N.reduce((r,y)=>r+y.amount,0)/N.length:0;let w=[...s];c==="winners"&&(w=w.filter(r=>r.amount>0)),c==="losers"&&(w=w.filter(r=>r.amount<0)),w.sort((r,y)=>{switch(h){case"latest":return new Date(y.date)-new Date(r.date);case"oldest":return new Date(r.date)-new Date(y.date);case"highest":return y.amount-r.amount;case"lowest":return r.amount-y.amount;default:return 0}});const T=r=>d?"****":`${n}${Math.abs(r).toLocaleString()}`;return e.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center p-2 sm:p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-xl sm:rounded-2xl border border-slate-700 w-full max-w-xs sm:max-w-md lg:max-w-3xl max-h-[95vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-slate-700/50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("span",{className:"text-2xl sm:text-3xl",children:x.tagEmoji}),e.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-black truncate",style:{color:x.tagColor},children:x.tagName})]}),e.jsxs("p",{className:"text-xs sm:text-sm text-slate-400",children:[o," • ",s.length," trade",s.length!==1?"s":""]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-lg transition-all flex-shrink-0",children:e.jsx(S,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-[10px] sm:text-xs text-slate-400 uppercase mb-1",children:"Total P&L"}),e.jsx("div",{className:`text-sm sm:text-base lg:text-lg font-black ${m>=0?"text-emerald-400":"text-red-400"}`,children:C(m,n,d)})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-[10px] sm:text-xs text-slate-400 uppercase mb-1",children:"Win Rate"}),e.jsxs("div",{className:"text-sm sm:text-base lg:text-lg font-black text-slate-200",children:[g,"%"]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-[10px] sm:text-xs text-slate-400 uppercase mb-1",children:"Avg Win"}),e.jsx("div",{className:"text-sm sm:text-base lg:text-lg font-black text-emerald-400",children:T(k)})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 sm:p-3",children:[e.jsx("div",{className:"text-[10px] sm:text-xs text-slate-400 uppercase mb-1",children:"Avg Loss"}),e.jsx("div",{className:"text-sm sm:text-base lg:text-lg font-black text-red-400",children:T(Math.abs(A))})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs("select",{value:h,onChange:r=>p(r.target.value),className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"latest",children:"Latest First"}),e.jsx("option",{value:"oldest",children:"Oldest First"}),e.jsx("option",{value:"highest",children:"Highest Amount"}),e.jsx("option",{value:"lowest",children:"Lowest Amount"})]}),e.jsxs("select",{value:c,onChange:r=>i(r.target.value),className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-700 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Trades"}),e.jsx("option",{value:"winners",children:"Winners Only"}),e.jsx("option",{value:"losers",children:"Losers Only"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:w.length===0?e.jsx("div",{className:"text-center py-8 sm:py-12 text-slate-500 text-sm",children:"No trades match the current filter"}):e.jsx("div",{className:"space-y-2 sm:space-y-3",children:w.map(r=>e.jsx("div",{className:"bg-slate-800/50 rounded-lg p-3 sm:p-4 border border-slate-700/30 hover:border-slate-600/50 transition-all",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsxs("div",{className:"flex-shrink-0 text-[10px] sm:text-xs text-slate-400",children:[new Date(r.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:o.length===4?void 0:"numeric"}),r.time&&e.jsxs("span",{className:"hidden sm:inline",children:[" • ",r.time]})]}),r.notes&&e.jsxs("div",{className:"flex-1 min-w-0 text-xs sm:text-sm text-slate-300 truncate",children:['"',r.notes,'"']}),e.jsx("div",{className:`flex-shrink-0 text-base sm:text-lg lg:text-xl font-black ${r.amount>=0?"text-emerald-400":"text-red-400"}`,children:C(r.amount,n,d)}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>l(r),className:"p-2 sm:p-2.5 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all min-w-[44px] min-h-[44px] sm:min-w-0 sm:min-h-0 flex items-center justify-center",title:"Edit trade",children:e.jsx(ee,{size:16,className:"sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>f(r.tradeId),className:"p-2 sm:p-2.5 bg-red-600 hover:bg-red-700 rounded-lg transition-all min-w-[44px] min-h-[44px] sm:min-w-0 sm:min-h-0 flex items-center justify-center",title:"Delete trade",children:e.jsx(Q,{size:16,className:"sm:w-4 sm:h-4"})}),r.driveImageId&&e.jsx("button",{onClick:()=>u(r),className:"p-2 sm:p-2.5 bg-purple-600 hover:bg-purple-700 rounded-lg transition-all min-w-[44px] min-h-[44px] sm:min-w-0 sm:min-h-0 flex items-center justify-center",title:"View screenshot",children:e.jsx(z,{size:16,className:"sm:w-4 sm:h-4"})})]})]})},r.tradeId))})})]})})},Ee=()=>{const{year:x,month:s}=he(),o=be(),n=new Date,d=parseInt(x)||n.getFullYear(),t=s!==void 0?parseInt(s):n.getMonth(),{data:l=[],isLoading:f}=fe(d,t),{data:u=[]}=ve(),h=U();ge();const p=X(a=>a.settings.currency),c=X(a=>a.settings.privacyMode),[i,m]=j.useState(null),[b,N]=j.useState(!1),[g,k]=j.useState(!1),[A,w]=j.useState(null),T=["January","February","March","April","May","June","July","August","September","October","November","December"],r=new Date(d,t+1,0).getDate(),y=new Date(d,t,1).getDay(),O=l.reduce((a,v)=>a+v.amount,0),R=l.filter(a=>a.amount>0),se=l.filter(a=>a.amount<0),W=l.length>0?Math.round(R.length/l.length*100):0,q=Le(l),D={};l.forEach(a=>{const v=parseInt(a.date.split("-")[2]);D[v]||(D[v]=[]),D[v].push(a)});const[le,B]=j.useState(!1),[$,J]=j.useState(null),[ae,V]=j.useState(!1),[P,Y]=j.useState(null),[ne,F]=j.useState(!1),[E,re]=j.useState(null),oe=a=>{J(a),B(!0)},H=a=>{m(a),N(!0)},ie=a=>{Y(a),V(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(pe,{}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950",children:[e.jsxs("div",{className:"max-w-[1800px] mx-auto p-6 pt-20",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>{const a=t===0?11:t-1,v=t===0?d-1:d;o(`/month/${v}/${a}`)},className:"group flex items-center gap-2 px-4 py-2 bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-xl transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx(ye,{size:20}),e.jsx("span",{className:"font-semibold",children:"Prev"})]}),e.jsxs("h1",{className:"text-3xl font-black bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:[T[t]," ",d]}),e.jsxs("button",{onClick:()=>{const a=t===11?0:t+1,v=t===11?d+1:d;o(`/month/${v}/${a}`)},className:"group flex items-center gap-2 px-4 py-2 bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-xl transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx("span",{className:"font-semibold",children:"Next"}),e.jsx(we,{size:20})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsx("div",{className:"col-span-9",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(a=>e.jsx("div",{className:"text-center text-slate-400 text-sm font-semibold py-2",children:a},a))}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[Array.from({length:y}).map((a,v)=>e.jsx("div",{className:"aspect-square"},`empty-${v}`)),Array.from({length:r}).map((a,v)=>{const I=v+1,G=D[I]||[],de=G.reduce((xe,ue)=>xe+ue.amount,0),ce=I===n.getDate()&&t===n.getMonth()&&d===n.getFullYear(),_=new Date(d,t,I).getDay(),me=_===0||_===6;return e.jsx(Ie,{day:I,trades:G,dayPL:de,isToday:ce,isWeekend:me,currency:p,privacyMode:c,onClick:()=>oe(I),onEditTrade:H},I)})]})]})}),e.jsxs("div",{className:"col-span-3 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Month Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(M,{label:"Total P&L",value:C(O,p,c),color:O>=0?"emerald":"red"}),e.jsx(M,{label:"Trades",value:l.length}),e.jsx(M,{label:"Winners",value:R.length,color:"emerald"}),e.jsx(M,{label:"Losers",value:se.length,color:"red"}),e.jsx(M,{label:"Win Rate",value:`${W}%`,color:W>=50?"emerald":"red"})]})]}),q.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Strategies"}),e.jsx("div",{className:"space-y-3",children:q.map(a=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:a.tagEmoji}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-xs font-bold truncate",style:{color:a.tagColor},children:a.tagName})})]}),e.jsx("div",{className:`text-lg font-black ${a.totalPL>=0?"text-emerald-400":"text-red-400"}`,children:C(a.totalPL,p,c)}),e.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:[a.trades,"T • ",a.winRate,"% WR"]})]},a.tagId))})]})]})]})]}),le&&$&&e.jsx(Ce,{day:$,year:d,month:t,trades:D[$]||[],tags:u,currency:p,privacyMode:c,onClose:()=>{B(!1),J(null)},onEditTrade:H}),b&&i&&e.jsx(De,{trade:i,tags:u,currency:p,onClose:()=>{N(!1),m(null)}}),g&&e.jsx(Me,{date:A,tags:u,currency:p,onClose:()=>{k(!1),w(null)}}),ae&&P&&e.jsx(ke,{imageUrl:P.imageUrl,trade:P,currency:p,privacyMode:c,onClose:()=>{V(!1),Y(null)}}),ne&&E&&e.jsx(Se,{tag:E,trades:l.filter(a=>a.tagId===E.tagId),scope:`${T[t]} ${d}`,currency:p,privacyMode:c,onClose:()=>{F(!1),re(null)},onEditTrade:a=>{m(a),N(!0),F(!1)},onDeleteTrade:async a=>{if(confirm("Delete this trade?"))try{await h.mutateAsync(a)}catch(v){alert("Failed to delete: "+v.message)}},onViewImage:a=>{const v=`https://drive.google.com/thumbnail?id=${a.driveImageId}&sz=w1200`;ie({...a,imageUrl:v}),F(!1)}})]})]})},Ie=({day:x,trades:s,dayPL:o,isToday:n,isWeekend:d,currency:t,privacyMode:l,onClick:f,onEditTrade:u})=>{const h=s.length>0,c=h?o>0?"bg-emerald-900/20 border-emerald-500/30":"bg-red-900/20 border-red-500/30":d?"bg-slate-800/20 border-slate-700/30":d?"":"bg-blue-950/20 border-blue-900/30";return e.jsxs("div",{onClick:f,className:`aspect-square rounded-lg border ${c} ${n?"ring-2 ring-blue-500":""} p-2 relative hover:bg-slate-700/30 transition-all cursor-pointer`,children:[e.jsx("div",{className:`text-sm font-semibold ${d?"text-slate-300":"text-blue-400/60"}`,children:x}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center text-lg font-black ${o>=0?"text-emerald-400":"text-red-400"}`,children:C(o,t,l)}),e.jsx("div",{className:"absolute bottom-1 left-1 grid grid-cols-2 gap-0.5 max-w-[70%]",children:[...new Set(s.map(i=>i.tagName).filter(Boolean))].slice(0,4).map(i=>e.jsx("span",{className:"text-[8px] text-slate-200 bg-slate-800/90 px-1 py-0.5 rounded font-semibold truncate border border-slate-700/50 leading-none",children:i},i))}),[...new Set(s.map(i=>i.tagName).filter(Boolean))].length>4&&e.jsx("div",{className:"absolute bottom-1 left-1 translate-y-full mt-0.5",children:e.jsxs("span",{className:"text-[7px] text-slate-400",children:["+",[...new Set(s.map(i=>i.tagName).filter(Boolean))].length-4]})}),s.length>0&&e.jsx("div",{className:"absolute bottom-1 right-1 w-5 h-5 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center shadow-lg border border-slate-700",children:e.jsx("span",{className:"text-[9px] font-black text-white",children:s.length})}),e.jsx("div",{className:"absolute inset-0"})]})]})},Ce=({day:x,year:s,month:o,trades:n,tags:d,currency:t,privacyMode:l,onClose:f,onEditTrade:u,onViewImage:h})=>{const p=U(),[c,i]=j.useState(n.length===0),m=["January","February","March","April","May","June","July","August","September","October","November","December"],b=`${s}-${String(o+1).padStart(2,"0")}-${String(x).padStart(2,"0")}`,N=async g=>{if(confirm("Delete this trade?"))try{await p.mutateAsync(g)}catch(k){alert("Failed to delete: "+k.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 sticky top-0 bg-slate-900 pb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-black",children:[m[o]," ",x,", ",s]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[n.length," trade",n.length!==1?"s":""]})]}),e.jsx("button",{onClick:f,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(S,{size:20})})]}),n.length>0&&!c&&e.jsx("div",{className:"space-y-3 mb-6",children:n.map(g=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 text-xs text-slate-500",children:g.time}),e.jsxs("div",{className:"flex-1",children:[g.tagName&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:g.tagEmoji}),e.jsx("span",{className:"text-xs font-semibold",style:{color:g.tagColor},children:g.tagName})]}),g.notes&&e.jsx("div",{className:"text-xs text-slate-400",children:g.notes})]}),e.jsx("div",{className:`text-xl font-black ${g.amount>=0?"text-emerald-400":"text-red-400"}`,children:C(g.amount,t,l)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{u(g),f()},className:"p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all",children:e.jsx(ee,{size:16})}),e.jsx("button",{onClick:()=>N(g.tradeId),className:"p-2 bg-red-600 hover:bg-red-700 rounded-lg transition-all",children:e.jsx(Q,{size:16})}),g.driveImageId&&e.jsx("button",{onClick:()=>{const k=`https://drive.google.com/thumbnail?id=${g.driveImageId}&sz=w1200`;h({...g,imageUrl:k})},className:"p-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-all",title:"View Screenshot",children:e.jsx(z,{size:16})})]})]},g.tradeId))}),c?e.jsxs("div",{className:"border-t border-slate-700 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-bold",children:"New Trade"}),n.length>0&&e.jsx("button",{onClick:()=>i(!1),className:"text-sm text-slate-400 hover:text-slate-300",children:"Cancel"})]}),e.jsx(Te,{date:b,tags:d,currency:t,onSuccess:()=>{i(!1)}})]}):e.jsxs("button",{onClick:()=>i(!0),className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold flex items-center justify-center gap-2",children:[e.jsx(Ne,{size:20}),"Add Another Trade"]})]})})},Te=({date:x,tags:s,currency:o,onSuccess:n})=>{const d=Z(),[t,l]=j.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),[f,u]=j.useState(null),h=c=>{var m;const i=(m=c.target.files)==null?void 0:m[0];if(i){if(!i.type.startsWith("image/")){alert("Please select an image file");return}l({...t,screenshot:i}),u(URL.createObjectURL(i))}},p=async c=>{c.preventDefault();try{const i=s.find(m=>m.tagId===t.tagId);await d.mutateAsync({tradeId:K(),date:x,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(i==null?void 0:i.name)||null,tagColor:(i==null?void 0:i.color)||null,tagEmoji:(i==null?void 0:i.emoji)||null,notes:t.notes,screenshot:t.screenshot}),n(),l({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),u(null)}catch(i){alert("Failed to save: "+i.message)}};return e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:c=>l({...t,time:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:["Amount (",o,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:c=>l({...t,amount:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",placeholder:"100",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Tag (Optional)"}),e.jsxs("select",{value:t.tagId,onChange:c=>l({...t,tagId:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),s.map(c=>e.jsxs("option",{value:c.tagId,children:[c.emoji," ",c.name]},c.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:t.notes,onChange:c=>l({...t,notes:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none resize-none",rows:2,placeholder:"Trade notes..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Screenshot (Optional)"}),f?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:f,alt:"Preview",className:"w-full h-32 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{l({...t,screenshot:null}),u(null)},className:"absolute top-2 right-2 p-1 bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(S,{size:16,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:h,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-4 text-center transition-all",children:[e.jsx(z,{size:24,className:"mx-auto mb-1 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Take Photo"})]})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:h,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-4 text-center transition-all",children:[e.jsx(te,{size:24,className:"mx-auto mb-1 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Upload"})]})]})]})]}),e.jsx("button",{type:"submit",disabled:d.isLoading,className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold disabled:opacity-50",children:d.isLoading?"Saving...":"Save Trade"})]})},De=({trade:x,tags:s,currency:o,onClose:n})=>{const d=je(),t=U(),[l,f]=j.useState({amount:x.amount,time:x.time,tagId:x.tagId||"",notes:x.notes||"",screenshot:null}),[u,h]=j.useState(x.driveImageId?`https://drive.google.com/thumbnail?id=${x.driveImageId}&sz=w800`:null),p=m=>{var N;const b=(N=m.target.files)==null?void 0:N[0];if(b){if(!b.type.startsWith("image/")){alert("Please select an image file");return}f({...l,screenshot:b}),h(URL.createObjectURL(b))}},c=async m=>{m.preventDefault();try{const b=s.find(N=>N.tagId===l.tagId);await d.mutateAsync({tradeId:x.tradeId,updates:{...l,tagName:(b==null?void 0:b.name)||null,tagColor:(b==null?void 0:b.color)||null,tagEmoji:(b==null?void 0:b.emoji)||null}}),n()}catch(b){alert("Failed to update: "+b.message)}},i=async()=>{if(confirm("Delete this trade? This cannot be undone."))try{await t.mutateAsync(x.tradeId),n()}catch(m){alert("Failed to delete: "+m.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"Edit Trade"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(S,{size:20})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:x.date,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:l.time,onChange:m=>f({...l,time:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",o,")"]}),e.jsx("input",{type:"number",step:"0.01",value:l.amount,onChange:m=>f({...l,amount:parseFloat(m.target.value)}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:l.tagId,onChange:m=>f({...l,tagId:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),s.map(m=>e.jsxs("option",{value:m.tagId,children:[m.emoji," ",m.name]},m.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:l.notes,onChange:m=>f({...l,notes:m.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Screenshot"}),u?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:u,alt:"Trade screenshot",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{f({...l,screenshot:null}),h(null)},className:"absolute top-2 right-2 p-2 bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(S,{size:20,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",capture:"environment",onChange:p,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-6 text-center transition-all",children:[e.jsx(z,{size:28,className:"mx-auto mb-2 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Take Photo"})]})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:p,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-6 text-center transition-all",children:[e.jsx(te,{size:28,className:"mx-auto mb-2 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Upload"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:i,className:"px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg transition-all font-semibold",children:"Delete"}),e.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d.isLoading,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold disabled:opacity-50",children:d.isLoading?"Saving...":"Save"})]})]})]})})},Me=({date:x,tags:s,currency:o,onClose:n})=>{const d=Z(),[t,l]=j.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:""}),f=async u=>{u.preventDefault();try{const h=s.find(p=>p.tagId===t.tagId);await d.mutateAsync({tradeId:K(),date:x,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(h==null?void 0:h.name)||null,tagColor:(h==null?void 0:h.color)||null,tagEmoji:(h==null?void 0:h.emoji)||null,notes:t.notes,driveImageId:null}),n()}catch(h){alert("Failed to save: "+h.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"New Trade"}),e.jsx("button",{onClick:n,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(S,{size:20})})]}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:x,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:u=>l({...t,time:u.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",o,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:u=>l({...t,amount:u.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",placeholder:"e.g., 100 or -50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:t.tagId,onChange:u=>l({...t,tagId:u.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),s.map(u=>e.jsxs("option",{value:u.tagId,children:[u.emoji," ",u.name]},u.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:u=>l({...t,notes:u.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3,placeholder:"Trade notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold",children:"Save Trade"})]})]})]})})},M=({label:x,value:s,color:o})=>{const n=o==="emerald"?"text-emerald-400":o==="red"?"text-red-400":"text-white";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wider",children:x}),e.jsx("span",{className:`text-lg font-black ${n}`,children:s})]})},Le=x=>{const s={};return x.forEach(o=>{const n=o.tagId||"none";n!=="none"&&(s[n]||(s[n]={tagId:n,tagName:o.tagName,tagColor:o.tagColor,tagEmoji:o.tagEmoji,totalPL:0,trades:0,wins:0}),s[n].totalPL+=o.amount,s[n].trades+=1,o.amount>0&&(s[n].wins+=1))}),Object.values(s).map(o=>({...o,winRate:o.trades>0?Math.round(o.wins/o.trades*100):0})).sort((o,n)=>n.totalPL-o.totalPL)};export{Ee as default};

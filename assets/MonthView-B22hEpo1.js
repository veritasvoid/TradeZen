import{c as F,h as ue,b as xe,d as be,e as G,r as j,j as e,f as ge,X as I}from"./index-ChzJFpsq.js";import{a as he,b as L,c as pe,d as _}from"./useTrades-BgmVAabJ.js";import{u as fe,a as k,g as H}from"./useTags-AOeOTrP0.js";import{I as je,T as ve,S as Ne,C as A}from"./TagTradesModal-DLxrIuje.js";import{T as ye}from"./trash-2-CXM0oSB6.js";import{P as we}from"./plus-UOUnyBv6.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=F("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=F("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=F("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ee=()=>{const{year:m,month:i}=ue(),d=xe(),l=new Date,u=parseInt(m)||l.getFullYear(),t=i!==void 0?parseInt(i):l.getMonth(),{data:a=[],isLoading:h}=he(u,t),{data:c=[]}=fe(),b=L();be();const p=G(s=>s.settings.currency),n=G(s=>s.settings.privacyMode),[r,o]=j.useState(null),[x,v]=j.useState(!1),[g,y]=j.useState(!1),[K,Q]=j.useState(null),z=["January","February","March","April","May","June","July","August","September","October","November","December"],Z=new Date(u,t+1,0).getDate(),ee=new Date(u,t,1).getDay(),P=a.reduce((s,f)=>s+f.amount,0),U=a.filter(s=>s.amount>0),te=a.filter(s=>s.amount<0),$=a.length>0?Math.round(U.length/a.length*100):0,E=Fe(a),w={};a.forEach(s=>{const f=parseInt(s.date.split("-")[2]);w[f]||(w[f]=[]),w[f].push(s)});const[se,R]=j.useState(!1),[T,O]=j.useState(null),[ae,V]=j.useState(!1),[C,q]=j.useState(null),[le,D]=j.useState(!1),[M,re]=j.useState(null),oe=s=>{O(s),R(!0)},W=s=>{o(s),v(!0)},B=s=>{q(s),V(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(ge,{}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950",children:[e.jsxs("div",{className:"max-w-[1800px] mx-auto p-6 pt-20",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>{const s=t===0?11:t-1,f=t===0?u-1:u;d(`/month/${f}/${s}`)},className:"group flex items-center gap-2 px-4 py-2 bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-xl transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx(Se,{size:20}),e.jsx("span",{className:"font-semibold",children:"Prev"})]}),e.jsxs("h1",{className:"text-3xl font-black bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:[z[t]," ",u]}),e.jsxs("button",{onClick:()=>{const s=t===11?0:t+1,f=t===11?u+1:u;d(`/month/${f}/${s}`)},className:"group flex items-center gap-2 px-4 py-2 bg-gradient-to-br from-slate-800 to-slate-900 hover:from-blue-600 hover:to-purple-600 rounded-xl transition-all border border-slate-700/50 shadow-lg hover:shadow-xl hover:scale-105",children:[e.jsx("span",{className:"font-semibold",children:"Next"}),e.jsx(Ie,{size:20})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsx("div",{className:"col-span-9",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(s=>e.jsx("div",{className:"text-center text-slate-400 text-sm font-semibold py-2",children:s},s))}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[Array.from({length:ee}).map((s,f)=>e.jsx("div",{className:"aspect-square"},`empty-${f}`)),Array.from({length:Z}).map((s,f)=>{const N=f+1,J=w[N]||[],ne=J.reduce((ce,me)=>ce+me.amount,0),de=N===l.getDate()&&t===l.getMonth()&&u===l.getFullYear(),Y=new Date(u,t,N).getDay(),ie=Y===0||Y===6;return e.jsx(ke,{day:N,trades:J,dayPL:ne,isToday:de,isWeekend:ie,currency:p,privacyMode:n,onClick:()=>oe(N),onEditTrade:W},N)})]})]})}),e.jsxs("div",{className:"col-span-3 space-y-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Month Stats"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{label:"Total P&L",value:k(P,p,n),color:P>=0?"emerald":"red"}),e.jsx(S,{label:"Trades",value:a.length}),e.jsx(S,{label:"Winners",value:U.length,color:"emerald"}),e.jsx(S,{label:"Losers",value:te.length,color:"red"}),e.jsx(S,{label:"Win Rate",value:`${$}%`,color:$>=50?"emerald":"red"})]})]}),E.length>0&&e.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-sm rounded-2xl border border-slate-700/50 p-6",children:[e.jsx("h3",{className:"text-sm uppercase tracking-wider text-slate-400 mb-4 font-semibold text-center",children:"Strategies"}),e.jsx("div",{className:"space-y-3",children:E.map(s=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xl",children:s.tagEmoji}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("div",{className:"text-xs font-bold truncate",style:{color:s.tagColor},children:s.tagName})})]}),e.jsx("div",{className:`text-lg font-black ${s.totalPL>=0?"text-emerald-400":"text-red-400"}`,children:k(s.totalPL,p,n)}),e.jsxs("div",{className:"text-[10px] text-slate-400 mt-1",children:[s.trades,"T â€¢ ",s.winRate,"% WR"]})]},s.tagId))})]})]})]})]}),se&&T&&e.jsx(Te,{day:T,year:u,month:t,trades:w[T]||[],tags:c,currency:p,privacyMode:n,onClose:()=>{R(!1),O(null)},onEditTrade:W,onViewImage:B}),x&&r&&e.jsx(De,{trade:r,tags:c,currency:p,onClose:()=>{v(!1),o(null)}}),g&&e.jsx(Me,{date:K,tags:c,currency:p,onClose:()=>{y(!1),Q(null)}}),ae&&C&&e.jsx(je,{imageUrl:C.imageUrl,trade:C,currency:p,privacyMode:n,onClose:()=>{V(!1),q(null)}}),le&&M&&e.jsx(ve,{tag:M,trades:a.filter(s=>s.tagId===M.tagId),scope:`${z[t]} ${u}`,currency:p,privacyMode:n,onClose:()=>{D(!1),re(null)},onEditTrade:s=>{o(s),v(!0),D(!1)},onDeleteTrade:async s=>{if(confirm("Delete this trade?"))try{await b.mutateAsync(s)}catch(f){alert("Failed to delete: "+f.message)}},onViewImage:s=>{const f=`https://drive.google.com/thumbnail?id=${s.driveImageId}&sz=w1200`;B({...s,imageUrl:f}),D(!1)}})]})]})},ke=({day:m,trades:i,dayPL:d,isToday:l,isWeekend:u,currency:t,privacyMode:a,onClick:h,onEditTrade:c})=>{const b=i.length>0,n=b?d>0?"bg-emerald-900/20 border-emerald-500/30":"bg-red-900/20 border-red-500/30":u?"bg-slate-800/20 border-slate-700/30":u?"":"bg-blue-950/20 border-blue-900/30";return e.jsxs("div",{onClick:h,className:`aspect-square rounded-lg border ${n} ${l?"ring-2 ring-blue-500":""} p-2 relative hover:bg-slate-700/30 transition-all cursor-pointer`,children:[e.jsx("div",{className:`text-sm font-semibold ${u?"text-slate-300":"text-blue-400/60"}`,children:m}),b&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`absolute inset-0 flex items-center justify-center text-lg font-black ${d>=0?"text-emerald-400":"text-red-400"}`,children:k(d,t,a)}),e.jsx("div",{className:"absolute bottom-1 left-1 grid grid-cols-2 gap-0.5 max-w-[70%]",children:[...new Set(i.map(r=>r.tagName).filter(Boolean))].slice(0,4).map(r=>e.jsx("span",{className:"text-[8px] text-slate-200 bg-slate-800/90 px-1 py-0.5 rounded font-semibold truncate border border-slate-700/50 leading-none",children:r},r))}),[...new Set(i.map(r=>r.tagName).filter(Boolean))].length>4&&e.jsx("div",{className:"absolute bottom-1 left-1 translate-y-full mt-0.5",children:e.jsxs("span",{className:"text-[7px] text-slate-400",children:["+",[...new Set(i.map(r=>r.tagName).filter(Boolean))].length-4]})}),i.length>0&&e.jsx("div",{className:"absolute bottom-1 right-1 w-5 h-5 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center shadow-lg border border-slate-700",children:e.jsx("span",{className:"text-[9px] font-black text-white",children:i.length})}),e.jsx("div",{className:"absolute inset-0"})]})]})},Te=({day:m,year:i,month:d,trades:l,tags:u,currency:t,privacyMode:a,onClose:h,onEditTrade:c,onViewImage:b})=>{const p=L(),[n,r]=j.useState(l.length===0),o=["January","February","March","April","May","June","July","August","September","October","November","December"],x=`${i}-${String(d+1).padStart(2,"0")}-${String(m).padStart(2,"0")}`,v=async g=>{if(confirm("Delete this trade?"))try{await p.mutateAsync(g)}catch(y){alert("Failed to delete: "+y.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 sticky top-0 bg-slate-900 pb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-black",children:[o[d]," ",m,", ",i]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[l.length," trade",l.length!==1?"s":""]})]}),e.jsx("button",{onClick:h,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(I,{size:20})})]}),l.length>0&&!n&&e.jsx("div",{className:"space-y-3 mb-6",children:l.map(g=>e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 text-xs text-slate-500",children:g.time}),e.jsxs("div",{className:"flex-1",children:[g.tagName&&e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm",children:g.tagEmoji}),e.jsx("span",{className:"text-xs font-semibold",style:{color:g.tagColor},children:g.tagName})]}),g.notes&&e.jsx("div",{className:"text-xs text-slate-400",children:g.notes})]}),e.jsx("div",{className:`text-xl font-black ${g.amount>=0?"text-emerald-400":"text-red-400"}`,children:k(g.amount,t,a)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{c(g),h()},className:"p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-all",children:e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:()=>v(g.tradeId),className:"p-2 bg-red-600 hover:bg-red-700 rounded-lg transition-all",children:e.jsx(ye,{size:16})}),g.driveImageId&&e.jsx("button",{onClick:()=>{const y=`https://drive.google.com/thumbnail?id=${g.driveImageId}&sz=w1200`;b({...g,imageUrl:y})},className:"p-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition-all",title:"View Screenshot",children:e.jsx(A,{size:16})})]})]},g.tradeId))}),n?e.jsxs("div",{className:"border-t border-slate-700 pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-bold",children:"New Trade"}),l.length>0&&e.jsx("button",{onClick:()=>r(!1),className:"text-sm text-slate-400 hover:text-slate-300",children:"Cancel"})]}),e.jsx(Ce,{date:x,tags:u,currency:t,onSuccess:()=>{r(!1)}})]}):e.jsxs("button",{onClick:()=>r(!0),className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold flex items-center justify-center gap-2",children:[e.jsx(we,{size:20}),"Add Another Trade"]})]})})},Ce=({date:m,tags:i,currency:d,onSuccess:l})=>{const u=_(),[t,a]=j.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),[h,c]=j.useState(null),b=n=>{var o;const r=(o=n.target.files)==null?void 0:o[0];if(r){if(!r.type.startsWith("image/")){alert("Please select an image file");return}a({...t,screenshot:r}),c(URL.createObjectURL(r))}},p=async n=>{n.preventDefault();try{const r=i.find(o=>o.tagId===t.tagId);await u.mutateAsync({tradeId:H(),date:m,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(r==null?void 0:r.name)||null,tagColor:(r==null?void 0:r.color)||null,tagEmoji:(r==null?void 0:r.emoji)||null,notes:t.notes,screenshot:t.screenshot}),l(),a({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:"",screenshot:null}),c(null)}catch(r){alert("Failed to save: "+r.message)}};return e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:n=>a({...t,time:n.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:["Amount (",d,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:n=>a({...t,amount:n.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",placeholder:"100",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Tag (Optional)"}),e.jsxs("select",{value:t.tagId,onChange:n=>a({...t,tagId:n.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),i.map(n=>e.jsxs("option",{value:n.tagId,children:[n.emoji," ",n.name]},n.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Notes (Optional)"}),e.jsx("textarea",{value:t.notes,onChange:n=>a({...t,notes:n.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 text-sm focus:border-blue-500 focus:outline-none resize-none",rows:2,placeholder:"Trade notes..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-slate-400 mb-2",children:"Screenshot (Optional)"}),h?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:h,alt:"Preview",className:"w-full h-32 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{a({...t,screenshot:null}),c(null)},className:"absolute top-2 right-2 p-1 bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(I,{size:16,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:async()=>{try{const n=await navigator.clipboard.read();for(const r of n)if(r.types.includes("image/png")){const o=await r.getType("image/png"),x=new File([o],"pasted-image.png",{type:"image/png"});a({...t,screenshot:x}),c(URL.createObjectURL(x));return}alert("No image found in clipboard. Copy an image first (Snipping Tool, screenshot, etc.)")}catch{alert("Failed to paste image. Try using Ctrl+V or copy an image first.")}},className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-4 text-center transition-all cursor-pointer",children:[e.jsx(A,{size:24,className:"mx-auto mb-1 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Paste Image"}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-1",children:"(Ctrl+V)"})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:b,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-4 text-center transition-all",children:[e.jsx(X,{size:24,className:"mx-auto mb-1 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Upload"})]})]})]})]}),e.jsx("button",{type:"submit",disabled:u.isLoading,className:"w-full py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold disabled:opacity-50",children:u.isLoading?"Saving...":"Save Trade"})]})},De=({trade:m,tags:i,currency:d,onClose:l})=>{console.log("ðŸ” Trade being edited:",m),console.log("ðŸ• Time value:",m.time,"Type:",typeof m.time);const u=pe(),t=L(),[a,h]=j.useState({amount:m.amount,time:m.time||"",tagId:m.tagId||"",notes:m.notes||"",screenshot:null}),[c,b]=j.useState(m.driveImageId?`https://drive.google.com/thumbnail?id=${m.driveImageId}&sz=w800`:null),p=o=>{var v;const x=(v=o.target.files)==null?void 0:v[0];if(x){if(!x.type.startsWith("image/")){alert("Please select an image file");return}h({...a,screenshot:x}),b(URL.createObjectURL(x))}},n=async o=>{o.preventDefault();try{const x=i.find(v=>v.tagId===a.tagId);await u.mutateAsync({tradeId:m.tradeId,updates:{...a,tagName:(x==null?void 0:x.name)||null,tagColor:(x==null?void 0:x.color)||null,tagEmoji:(x==null?void 0:x.emoji)||null}}),l()}catch(x){alert("Failed to update: "+x.message)}},r=async()=>{if(confirm("Delete this trade? This cannot be undone."))try{await t.mutateAsync(m.tradeId),l()}catch(o){alert("Failed to delete: "+o.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"Edit Trade"}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:m.date,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:a.time,onChange:o=>h({...a,time:o.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",d,")"]}),e.jsx("input",{type:"number",step:"0.01",value:a.amount,onChange:o=>h({...a,amount:parseFloat(o.target.value)}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:a.tagId,onChange:o=>h({...a,tagId:o.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),i.map(o=>e.jsxs("option",{value:o.tagId,children:[o.emoji," ",o.name]},o.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:a.notes,onChange:o=>h({...a,notes:o.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Screenshot"}),c?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c,alt:"Trade screenshot",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{h({...a,screenshot:null}),b(null)},className:"absolute top-2 right-2 p-2 bg-black/50 rounded-full hover:bg-black/70",children:e.jsx(I,{size:20,className:"text-white"})})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:async()=>{try{const o=await navigator.clipboard.read();for(const x of o)if(x.types.includes("image/png")){const v=await x.getType("image/png"),g=new File([v],"pasted-image.png",{type:"image/png"});h({...a,screenshot:g}),b(URL.createObjectURL(g));return}alert("No image found in clipboard. Copy an image first (Snipping Tool, screenshot, etc.)")}catch{alert("Failed to paste image. Try using Ctrl+V or copy an image first.")}},className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-6 text-center transition-all cursor-pointer",children:[e.jsx(A,{size:28,className:"mx-auto mb-2 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Paste Image"}),e.jsx("div",{className:"text-[10px] text-slate-500 mt-1",children:"(Ctrl+V)"})]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:p,className:"hidden"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-700 hover:border-slate-600 rounded-lg p-6 text-center transition-all",children:[e.jsx(X,{size:28,className:"mx-auto mb-2 text-slate-400"}),e.jsx("div",{className:"text-xs text-slate-400",children:"Upload"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-3 bg-red-600 hover:bg-red-700 rounded-lg transition-all font-semibold",children:"Delete"}),e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u.isLoading,className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold disabled:opacity-50",children:u.isLoading?"Saving...":"Save"})]})]})]})})},Me=({date:m,tags:i,currency:d,onClose:l})=>{const u=_(),[t,a]=j.useState({amount:"",time:new Date().toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit"}),tagId:"",notes:""}),h=async c=>{c.preventDefault();try{const b=i.find(p=>p.tagId===t.tagId);await u.mutateAsync({tradeId:H(),date:m,time:t.time,amount:parseFloat(t.amount),tagId:t.tagId||null,tagName:(b==null?void 0:b.name)||null,tagColor:(b==null?void 0:b.color)||null,tagEmoji:(b==null?void 0:b.emoji)||null,notes:t.notes,driveImageId:null}),l()}catch(b){alert("Failed to save: "+b.message)}};return e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-slate-900 rounded-2xl border border-slate-700 max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-2xl font-black",children:"New Trade"}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-slate-800 rounded-lg",children:e.jsx(I,{size:20})})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Date"}),e.jsx("input",{type:"text",value:m,readOnly:!0,className:"w-full bg-slate-800/50 border border-slate-700 rounded-lg px-4 py-3 text-slate-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Time"}),e.jsx("input",{type:"time",value:t.time,onChange:c=>a({...t,time:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:["Amount (",d,")"]}),e.jsx("input",{type:"number",step:"0.01",value:t.amount,onChange:c=>a({...t,amount:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",placeholder:"e.g., 100 or -50",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Tag"}),e.jsxs("select",{value:t.tagId,onChange:c=>a({...t,tagId:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"No Tag"}),i.map(c=>e.jsxs("option",{value:c.tagId,children:[c.emoji," ",c.name]},c.tagId))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-400 mb-2",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:c=>a({...t,notes:c.target.value}),className:"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 focus:border-blue-500 focus:outline-none resize-none",rows:3,placeholder:"Trade notes..."})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg transition-all font-semibold",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:shadow-lg rounded-lg transition-all font-semibold",children:"Save Trade"})]})]})]})})},S=({label:m,value:i,color:d})=>{const l=d==="emerald"?"text-emerald-400":d==="red"?"text-red-400":"text-white";return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wider",children:m}),e.jsx("span",{className:`text-lg font-black ${l}`,children:i})]})},Fe=m=>{const i={};return m.forEach(d=>{const l=d.tagId||"none";l!=="none"&&(i[l]||(i[l]={tagId:l,tagName:d.tagName,tagColor:d.tagColor,tagEmoji:d.tagEmoji,totalPL:0,trades:0,wins:0}),i[l].totalPL+=d.amount,i[l].trades+=1,d.amount>0&&(i[l].wins+=1))}),Object.values(i).map(d=>({...d,winRate:d.trades>0?Math.round(d.wins/d.trades*100):0})).sort((d,l)=>l.totalPL-d.totalPL)};export{Ee as default};
